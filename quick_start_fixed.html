---
layout: default
title: Quick Start Fixed Length
permalink: /quick_start_fixed/
---

<h3>Quick Start for Fixed Length files</h3>

<div style="left-margin: 20px;">
    Or check the <a href="{{ site.baseurl }}/quick_start">Delimited file example</a> or <a href="{{ site.baseurl }}/quick_start_async">record by record example</a><br /><br />
</div>

<h4><a name="first"></a>Step 1</h4>

<p>To start using the FileHelpers library
you only need to add a reference in your project to the file:
<strong>FileHelpers.dll</strong>. You can find it in the Release
directory of the distribution. Tip: remember to leave the
<strong>FileHelpers.xml</strong> file to get Visual Studio Intellisense support. </p>
<div style="left-margin: 20px;">
<p><img src="{{ site.baseurl }}/images/references.png" width="103" height="53" alt="add references"/></p>
</div>

<h4><a name="two"></a>Step 2</h4>
<p> Next, you need to define a class that maps to the record in the
source/destination file.</p>
<p>For this example we use this format file:</p>

<h5>Sample data</h5>
{% highlight csharp %}
01732Juan Perez           004350011052002
00554Pedro Gomez          123423006022004
00112Ramiro Politti       000000001022000
00924Pablo Ramirez        033213024112002
...............    
{% endhighlight %}

<p>Next you write a class listing the fields:</p>

{% highlight csharp %}
[FixedLengthRecord()]
public class Customer2
{
	[FieldFixedLength(5)]
	public int CustId;
	
	[FieldFixedLength(20)]
	[FieldTrim(TrimMode.Right)]
	public string Name;

	[FieldFixedLength(8)]
	[FieldConverter(typeof(TwoDecimalConverter))]
	public decimal Balance;

	[FieldFixedLength(8)]
	[FieldConverter(ConverterKind.Date, "ddMMyyyy")]
	public DateTime AddedDate;

	// A custom converter
	internal class TwoDecimalConverter: ConverterBase
	{
		public override object StringToField(string from)
		{
			decimal res = Convert.ToDecimal(from);
			return res / 100;
		}

		public override string FieldToString(object from)
		{
			decimal d = (decimal) from;
			return Math.Round(d * 100).ToString();
		}
	}
}
{% endhighlight %}

<h4><a name="three"></a>Step 3</h4>

<p>Then you need to create a FileHelperEngine and read or write the files:</p>

{% highlight csharp %}
var engine = new FileHelperEngine<Customer>();

// To Read Use:
var result = engine.ReadFile("FileIn.txt");
// result is now an array of Customer

// To Write Use:
engine.WriteFile("FileOut.txt", result);
{% endhighlight %}

<h4><a name="four"></a>Step 4</h4>

<p>We can use the result array to access each item in the file, for example: </p>

{% highlight csharp %}
foreach (Customer cust in result)
{
    Console.WriteLine("Customer Info:");
    Console.WriteLine(cust.Name + " - " +
                      cust.AddedDate.ToString("dd/MM/yy"));
}
{% endhighlight %}

